<Page x:Class="POS_ModernUI.Views.Pages.SettingsUsersPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:helpers="clr-namespace:POS_ModernUI.Helpers"
      xmlns:local="clr-namespace:POS_ModernUI.Views.Pages"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
      xmlns:conv="clr-namespace:POS_ModernUI.Helpers"
      Title="SettingsUsersPage"
      d:DataContext="{d:DesignInstance local:SettingsUsersPage,
                                          IsDesignTimeCreatable=False}"
      d:DesignHeight="650"
      d:DesignWidth="1000"
      ui:Design.Background="{DynamicResource ApplicationBackgroundBrush}"
      ui:Design.Foreground="{DynamicResource TextFillColorPrimaryBrush}"
      Foreground="{DynamicResource TextFillColorPrimaryBrush}"
      mc:Ignorable="d"
      FlowDirection="RightToLeft">

    <Page.Resources>
        <conv:CusBooleanToVisibility x:Key="CusBooleanToVisibility"/>
    </Page.Resources>
    <Grid>
        <ui:ProgressRing IsIndeterminate="True"
                 Width="100"
                 Height="100"
                 Visibility="{Binding ViewModel.IsLoading, Converter={StaticResource CusBooleanToVisibility}}"/>

        <TextBlock Text="{Binding ViewModel.Title}"
                   FontSize="30"
                   Margin="5"/>

        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <StackPanel VerticalAlignment="Center"
                        HorizontalAlignment="Center">
                <ui:TextBox PlaceholderText="إسم المستخدم"
                         Margin="10"
                         Width="300"
                         Height="40"
                         Text="{Binding ViewModel.UserName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                <ui:PasswordBox PlaceholderText="كلمة السر"
                                Margin="10"
                                Width="300"
                                Height="40"
                                Password="{Binding ViewModel.Password, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

                <ui:ToggleSwitch Grid.Row="0"
                                 Margin="10 5"
                                 Content="الصلاحيات الكاملة"
                                 Cursor="Hand"
                                 IsChecked="{Binding ViewModel.IsAll, Mode=TwoWay}"
                                 HorizontalAlignment="Left"/>
                
                <ui:ToggleSwitch Grid.Row="0"
                                 Margin="10 5"
                                 Content="السماح للمستخدم بالوصول الى الكاشير"
                                 Cursor="Hand"
                                 IsChecked="{Binding ViewModel.IsCasher, Mode=TwoWay}"
                                 HorizontalAlignment="Left"/>
                
                <ui:ToggleSwitch Grid.Row="0"
                                 Margin="10 5"
                                 Content="السماح للمستخدم بالوصول الى المبيعات"
                                 Cursor="Hand"
                                 IsChecked="{Binding ViewModel.IsSales, Mode=TwoWay}"
                                 HorizontalAlignment="Left"/>
                <ui:ToggleSwitch Grid.Row="0"
                                 Margin="10 5"
                                 Content="السماح للمستخدم بالوصول الى المشتريات"
                                 Cursor="Hand"
                                 IsChecked="{Binding ViewModel.IsPurchases, Mode=TwoWay}"
                                 HorizontalAlignment="Left"/>
                <ui:ToggleSwitch Grid.Row="0"
                                 Margin="10 5"
                                 Content="السماح للمستخدم بالوصول الى المنتجات"
                                 Cursor="Hand"
                                 IsChecked="{Binding ViewModel.IsProduct, Mode=TwoWay}"
                                 HorizontalAlignment="Left"/>
                <ui:ToggleSwitch Grid.Row="0"
                                 Margin="10 5"
                                 Content="السماح للمستخدم بالوصول الى العملاء"
                                 Cursor="Hand"
                                 IsChecked="{Binding ViewModel.IsCustomer, Mode=TwoWay}"
                                 HorizontalAlignment="Left"/>
                <ui:ToggleSwitch Grid.Row="0"
                                 Margin="10 5"
                                 Content="السماح للمستخدم بالوصول الى الديون"
                                 Cursor="Hand"
                                 IsChecked="{Binding ViewModel.IsDebts, Mode=TwoWay}"
                                 HorizontalAlignment="Left"/>
                <ui:ToggleSwitch Grid.Row="0"
                                 Margin="10 5"
                                 Content="السماح للمستخدم بالوصول الى الإعدادات"
                                 Cursor="Hand"
                                 IsChecked="{Binding ViewModel.IsSettings, Mode=TwoWay}"
                                 HorizontalAlignment="Left"/>

                <ui:Button Content="حفظ"
                           Appearance="Primary"
                           Command="{Binding ViewModel.SaveUserCommand}"
                           Width="300"
                           Margin="10"/>
                <ui:Button Content="إلغاء"
                           Appearance="Danger"
                           Visibility="{Binding ViewModel.IsEditMode, Converter={StaticResource CusBooleanToVisibility}}"
                           Command="{Binding ViewModel.CancelCommand}"
                           Width="300"
                           Margin="10 0"/>
            </StackPanel>
            
            <DataGrid ItemsSource="{Binding ViewModel.Users, Mode=TwoWay}"
                      VirtualizingPanel.IsVirtualizing="True"
                      VirtualizingPanel.VirtualizationMode="Recycling"
                      Grid.Column="1"
                      FontSize="15"
                      Margin="10"
                      Padding="7"
                      CanUserReorderColumns="False"
                      CanUserResizeColumns="False"
                      AutoGenerateColumns="False"
                      CanUserResizeRows="False"
                      VerticalScrollBarVisibility="Auto"
                      CanUserAddRows="False"
                      IsReadOnly="True">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="إسم المستخدم"
                                        Binding="{Binding Name}"
                                        HeaderStyle="{DynamicResource CenterGridHeaderStyle}"
                                        ElementStyle="{StaticResource CenterDtaGridCell}"
                                        Width="*">
                        <DataGridTextColumn.CellStyle>
                            <Style TargetType="DataGridCell">
                                <Setter Property="ToolTip">
                                    <Setter.Value>
                                        <TextBlock FontSize='17' />
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </DataGridTextColumn.CellStyle>
                    </DataGridTextColumn>

                    <DataGridTextColumn Header="كلمة السر"
                                        Binding="{Binding Password}"
                                        ElementStyle="{StaticResource CenterDtaGridCell}"
                                        HeaderStyle="{DynamicResource CenterGridHeaderStyle}"
                                        Width=".75*">
                        <DataGridTextColumn.CellStyle>
                            <Style TargetType="DataGridCell">
                                <Setter Property="ToolTip">
                                    <Setter.Value>
                                        <TextBlock FontSize='17' />
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </DataGridTextColumn.CellStyle>
                    </DataGridTextColumn>

                    <DataGridTextColumn Header="الصلاحية"
                                        Binding="{Binding RoleLevel}"
                                        ElementStyle="{StaticResource CenterDtaGridCell}"
                                        HeaderStyle="{DynamicResource CenterGridHeaderStyle}"
                                        Width="*">
                        <DataGridTextColumn.CellStyle>
                            <Style TargetType="DataGridCell">
                                <Setter Property="ToolTip">
                                    <Setter.Value>
                                        <TextBlock FontSize='17' />
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </DataGridTextColumn.CellStyle>
                    </DataGridTextColumn>


                    <DataGridTemplateColumn Header="عملیات"
                                            Width="180"
                                            HeaderStyle="{DynamicResource CenterGridHeaderStyle}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal"
                                            HorizontalAlignment="Center">
                                    <Button Margin="4"
                                            Padding="7,5"
                                            CommandParameter="{Binding}"
                                            Command="{Binding Path=DataContext.ViewModel.SelectUserCommand, RelativeSource= {RelativeSource FindAncestor,AncestorType={x:Type DataGrid}}}">
                                        <ui:SymbolIcon Symbol="Pen16" />
                                        <Button.ToolTip>
                                            <TextBlock Text="تعديل"
                                                       FontSize="14" />
                                        </Button.ToolTip>
                                    </Button>
                                    <Button Margin="4"
                                            Padding="7,5"
                                            CommandParameter="{Binding}"
                                            Command="{Binding Path=DataContext.ViewModel.DeleteUserCommand, RelativeSource= {RelativeSource FindAncestor,AncestorType={x:Type DataGrid}}}">
                                        <ui:SymbolIcon Symbol="Delete16" />
                                        <Button.ToolTip>
                                            <TextBlock Text="حذف"
                                                       FontSize="14" />
                                        </Button.ToolTip>
                                    </Button>
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>
    </Grid>
</Page>
