<Page x:Class="POS_ModernUI.Views.Pages.CustomersView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:local="clr-namespace:POS_ModernUI.Views.Pages"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
      xmlns:vm="clr-namespace:POS_ModernUI.ViewModels.Pages"
      xmlns:conv="clr-namespace:POS_ModernUI.Helpers" 
      xmlns:dialogs="clr-namespace:POS_ModernUI.Views.Dialogs"
      Title="DebtsPage"
      d:DataContext="{d:DesignInstance local:CustomersView,
                                          IsDesignTimeCreatable=False}"
      d:DesignHeight="800"
      d:DesignWidth="1400"
      ui:Design.Background="{DynamicResource ApplicationBackgroundBrush}"
      ui:Design.Foreground="{DynamicResource TextFillColorPrimaryBrush}"
      Foreground="{DynamicResource TextFillColorPrimaryBrush}"
      mc:Ignorable="d"
      FlowDirection="RightToLeft">

    <Page.Resources>
        <conv:CusBooleanToVisibility x:Key="CusBooleanToVisibility"/>
    </Page.Resources>
    
    <Grid>
        <ui:ProgressRing IsIndeterminate="True"
                         Width="100"
                         Height="100"
                         Visibility="{Binding ViewModel.IsLoading, Converter={StaticResource CusBooleanToVisibility}}"/>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Grid Grid.Row="0">
                <StackPanel Height="35"
                            VerticalAlignment="Bottom"
                            HorizontalAlignment="Left"
                            Orientation="Horizontal"
                            Margin="60,0,0,2">


                    <ui:SymbolIcon Symbol="Search12"
                                   Foreground="Wheat"
                                   HorizontalAlignment="Left"
                                   Margin="0,0,10,0"/>
                    <ui:TextBox PlaceholderText="ابحث عن العميل بالاسم او برقم الهاتف....."
                                Height="35"
                                Width="300"
                                Text="{Binding ViewModel.SearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                </StackPanel>

                <ui:Button Content="إضافة عميل جديد"
                           HorizontalAlignment="Right"
                           VerticalAlignment="Bottom"
                           Margin="0,0,10,5"
                           Padding="40 5"
                           Cursor="Hand"
                           Appearance="Success"
                           Foreground="WhiteSmoke"
                           FontSize="16"
                           FontWeight="DemiBold"
                           Command="{Binding ViewModel.AddOrUpdateCustomerCommand}"/>
            </Grid>
            <DataGrid ItemsSource="{Binding ViewModel.Customers, Mode=TwoWay}"
                  VirtualizingPanel.IsVirtualizing="True"
                  VirtualizingPanel.VirtualizationMode="Recycling"
                  Grid.Row="2"
                  FontSize="15"
                  Margin="10"
                  Padding="7"
                  CanUserReorderColumns="False"
                  CanUserResizeColumns="False"
                  AutoGenerateColumns="False"
                  CanUserResizeRows="False"
                  VerticalScrollBarVisibility="Auto"
                  CanUserAddRows="False"
                  IsReadOnly="True">
            <DataGrid.Columns>
                <DataGridTextColumn Header="إسم العميل"
                    Binding="{Binding Name}"
                    HeaderStyle="{DynamicResource CenterGridHeaderStyle}"
                    ElementStyle="{StaticResource CenterDtaGridCell}"
                    Width="*">
                    <DataGridTextColumn.CellStyle>
                        <Style TargetType="DataGridCell">
                            <Setter Property="ToolTip">
                                <Setter.Value>
                                    <TextBlock FontSize='17' />
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </DataGridTextColumn.CellStyle>
                </DataGridTextColumn>

                <DataGridTextColumn Header="رقم الهاتف"
                                    Binding="{Binding Phone}"
                                    ElementStyle="{StaticResource CenterDtaGridCell}"
                                    HeaderStyle="{DynamicResource CenterGridHeaderStyle}"
                                    Width=".75*">
                    <DataGridTextColumn.CellStyle>
                        <Style TargetType="DataGridCell">
                            <Setter Property="ToolTip">
                                <Setter.Value>
                                    <TextBlock FontSize='17' />
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </DataGridTextColumn.CellStyle>
                </DataGridTextColumn>

                <DataGridTextColumn Header="العنوان"
                                    Binding="{Binding Address}"
                                    ElementStyle="{StaticResource CenterDtaGridCell}"
                                    HeaderStyle="{DynamicResource CenterGridHeaderStyle}"
                                    Width="*">
                    <DataGridTextColumn.CellStyle>
                        <Style TargetType="DataGridCell">
                            <Setter Property="ToolTip">
                                <Setter.Value>
                                    <TextBlock FontSize='17' />
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </DataGridTextColumn.CellStyle>
                </DataGridTextColumn>

                <DataGridTextColumn Header="ملاحظات"
                    Binding="{Binding Notes}"
                    ElementStyle="{StaticResource CenterDtaGridCell}"
                    HeaderStyle="{DynamicResource CenterGridHeaderStyle}"
                    Width="*">
                    <DataGridTextColumn.CellStyle>
                        <Style TargetType="DataGridCell">
                            <Setter Property="ToolTip">
                                <Setter.Value>
                                    <TextBlock FontSize='17' />
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </DataGridTextColumn.CellStyle>
                </DataGridTextColumn>


                <DataGridTemplateColumn Header="عملیات"
                                        Width="180"
                                        HeaderStyle="{DynamicResource CenterGridHeaderStyle}">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal"
                                        HorizontalAlignment="Center">
                                <Button Margin="4"
                                        Padding="7,5"
                                        CommandParameter="{Binding}"
                                        Command="{Binding Path=DataContext.ViewModel.ShowCustomersDetailsCommand, RelativeSource= {RelativeSource FindAncestor,AncestorType={x:Type DataGrid}}}">
                                    <ui:SymbolIcon Symbol="NotepadPerson24" />
                                    <Button.ToolTip>
                                        <TextBlock Text="سجلات العميل"
                                                   FontSize="14" />
                                    </Button.ToolTip>
                                </Button>
                                <Button Margin="4"
                                        Padding="7,5"
                                        CommandParameter="{Binding}"
                                        Command="{Binding Path=DataContext.ViewModel.AddOrUpdateCustomerCommand, RelativeSource= {RelativeSource FindAncestor,AncestorType={x:Type DataGrid}}}">
                                    <ui:SymbolIcon Symbol="Pen16" />
                                    <Button.ToolTip>
                                        <TextBlock Text="تعديل"
                                                   FontSize="14" />
                                    </Button.ToolTip>
                                </Button>
                                <Button Margin="4"
                                        Padding="7,5"
                                        CommandParameter="{Binding}"
                                        Command="{Binding Path=DataContext.ViewModel.DeleteCustomerCommand, RelativeSource= {RelativeSource FindAncestor,AncestorType={x:Type DataGrid}}}">
                                    <ui:SymbolIcon Symbol="Delete16" />
                                    <Button.ToolTip>
                                        <TextBlock Text="حذف"
                                           FontSize="14" />
                                    </Button.ToolTip>
                                </Button>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>
        </Grid>
    </Grid>
</Page>
